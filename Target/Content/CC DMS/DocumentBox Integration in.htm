<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" xml:space="preserve">
    <head><title></title>
    </head>
    <body>
        <h2 class="Heading2" MadCap:autonum="1.1    "><a name="_Toc434330854"></a>DocumentBox Integration in Microsoft Dynamics NAV Pages</h2>
        <p class="ccTextvorlage">The integration of <span class="CCBausteinInhaltZchn">cc|dms</span> into Microsoft Dynamics NAV is based on a FactBox as SubPage named “DocumentBox”, linked to page 5306027 (DMS - Doc. Box FactBox Async). The FactBox contains the client add-in and the user should have rights to open (execute) this page.</p>
        <p class="ccBildabstand">
            <img src="../Resources/Images/CC DMS/DocumentBox Integration in.png" MadCap:mediastyle="@media print { max-width: 6in; }" />
        </p>
        <p class="ccBildFigure" MadCap:autonum="Fig. 1">: DocumentBox Client Add-in on Sales Order Card</p>
        <p class="ccTextvorlage">The parent PageType should be “Card”, “List” or any similar type. Since the integration is a FactBox, the DocumentBox does not work on ListPart or any included (sub-) pages.</p>
        <p class="ccBildabstand">
            <img src="../Resources/Images/CC DMS/DocumentBox Integration in_1.png" MadCap:mediastyle="@media print { max-width: 6in; }" />
        </p>
        <p class="ccBildFigure" MadCap:autonum="Fig. 2">: Implementation DocumentBox as FactBox</p>
        <p class="ccTextvorlage">It is necessary to pass a record to obtain all documents, regarding the record. It is the best way to create a function on the page with the name “UpdateDocumentBox()”, which is called from the Trigger “OnAfterGetCurrRecord()”. </p>
        <p class="ccBildabstand">
            <img src="../Resources/Images/CC DMS/DocumentBox Integration in_2.png" MadCap:mediastyle="@media print { max-width: 6in; }" />
        </p>
        <p class="ccBildFigure" MadCap:autonum="Fig. 3">: Implementation Source Code to Update DocumentBox</p>
        <p class="ccTextvorlage">The DocumentBox provides the “CurrPage.DocumentBox.PAGE.SetRecordRef()” function to pass the record as RecordReference and returns “TRUE” if the client add-in's document list needs to be updated. The “CurrPage.DocumentBox.PAGE.UpdateDocumentBox()” function will obtain all SharePoint documents and display them in the DocumentBox.</p>
        <p class="ccBildabstand">
            <img src="../Resources/Images/CC DMS/DocumentBox Integration in_3.png" MadCap:mediastyle="@media print { max-width: 6in; }" />
        </p>
        <p class="ccBildFigure" MadCap:autonum="Fig. 4">: Implementation Source Code to Update DocumentBox</p>
        <p class="ccTextvorlage">This source code will load and update all documents regarding the configuration, while opening the card and changing the record.</p>
        <p class="ccTextvorlage">To print and upload a report, an additional implementation for the printing action is necessary. If it is a standard document, printed by Codeunit 229 and based on the Report Selection table, execute the “Upload[...]” function (e.g. “UploadSalesHeader()”). Otherwise check for an “Upload[...]” function in the Table object or copy and customize the content of the “ProcessPDFAndUpload()” function from Codeunit 229. Update the DocumentBox after executing the upload.</p>
        <p class="ccBildabstand">
            <img src="../Resources/Images/CC DMS/DocumentBox Integration in_4.png" MadCap:mediastyle="@media print { max-width: 6in; }" />
        </p>
        <p class="ccBildFigure" MadCap:autonum="Fig. 5">: Implementation PDF and Upload action</p>
    </body>
</html>